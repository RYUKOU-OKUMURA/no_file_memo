# AGENT.md - AI アシスタント運用ガイドライン

## アプリケーションアーキテクチャ

### 静的HTMLアプリケーション
```poml
アプリケーション名: No File Memory
種別: 静的HTML単一ファイル
アーキテクチャ:
  - HTML: 完全スタンドアロンアプリケーション
  - CSS: インラインスタイル埋め込み
  - JavaScript: インラインスクリプト埋め込み
  - 依存関係: 不要
  - サーバー要件: 開発時のみオプション
  - データ保存: ブラウザローカルストレージ
  - オフライン機能: 完全対応
  - デプロイ方法:
    - 方法1: ブラウザでファイル直接開く
    - 方法2: 静的ファイルサーバー
    - 方法3: GitHub Pages対応
```

### 技術スタック
```poml
スタック:
  フロントエンド:
    - HTML5: セマンティックマークアップ
    - CSS3: カスタムプロパティとグリッド
    - JavaScript: バニラES6以上
    - ストレージ: localStorage API
  バックエンド:
    - サーバー: Python HTTPサーバー（オプション）
    - プロセス管理: supervisor デーモン
    - ポート: 8080（デフォルト）
  デプロイ:
    - 静的ホスティング: GitHub Pages対応
    - CDN対応: あり
    - サーバー独立: あり
```

## Git操作ポリシー

### 必須ユーザー確認
```poml
Git操作:
  コミット:
    自動コミット: 禁止
    ユーザー確認: 必須
    手順:
      - ステップ1: 変更内容の概要表示
      - ステップ2: ユーザーに許可を求める
      - ステップ3: 明示的な承認を待つ
      - ステップ4: 確認後にのみ実行
  
  プッシュ:
    自動プッシュ: 厳格に禁止
    ユーザー確認: 常時必要
    手順:
      - ステップ1: プッシュ対象と内容を説明
      - ステップ2: 明示的な許可を求める
      - ステップ3: ユーザー承認を待つ
      - ステップ4: 確認後にのみ実行
      
  プルリクエスト:
    自動作成: 許可しない
    ユーザー確認: 不可欠
    手順:
      - ステップ1: PR内容と目的を説明
      - ステップ2: ユーザーに許可を求める
      - ステップ3: 承認を待つ
      - ステップ4: 確認後にのみ作成
```

### Gitワークフロー要件
```poml
ワークフロー:
  ブランチ戦略:
    - main: プロダクション対応コード
    - feature_branches: 開発用
    - PR必須: 全変更に対して
    
  コミット基準:
    - フォーマット: conventional commits
    - スコープ: 明確で説明的
    - 本文: 必要に応じて詳細説明
    
  ユーザーインタラクション:
    - git add前: ファイル変更を表示
    - コミット前: コミットメッセージのプレビュー
    - プッシュ前: 対象リポジトリの説明
    - PR前: 変更内容と目的の説明
```

## 開発ガイドライン

### ファイル構造
```poml
プロジェクト構造:
  メインアプリケーション:
    - memotuck.html: 主要アプリケーションファイル
    - index.html: リダイレクト付きランディングページ
  
  設定ファイル:
    - server.py: 開発用HTTPサーバー
    - supervisord.conf: デーモンプロセス管理
    - .gitignore: バージョン管理除外設定
  
  ドキュメント:
    - README.md: ユーザー向けドキュメント
    - AGENT.md: AIアシスタントガイドライン
  
  実行時ファイル:
    - ログファイル: supervisorとサーバーログ
    - PIDファイル: プロセス管理ファイル
```

### サーバー管理
```poml
サーバー操作:
  開発サーバー:
    - 種別: Python HTTP静的サーバー
    - 管理: supervisor デーモン
    - 自動再起動: 有効
    - ポート: 8080（デフォルト）
    
  コマンド:
    開始: supervisord -c supervisord.conf
    状態確認: supervisorctl -c supervisord.conf status
    再起動: supervisorctl -c supervisord.conf restart memotuck-server
    停止: supervisorctl -c supervisord.conf stop memotuck-server
    
  URLアクセス:
    - ローカル: http://localhost:8080/memotuck.html
    - サンドボックス: GetServiceUrlツールを使用
    - パブリック: e2bサンドボックスが提供
```

## ユーザーインタラクションプロトコル

### GitHub操作確認
```poml
確認が必要な操作:
  gitコミット:
    メッセージ: "以下の変更をコミットしますか？"
    詳細表示:
      - 変更ファイル: 全変更ファイル一覧
      - コミットメッセージ: 提案メッセージ表示
      - 変更概要: 変更内容の簡潔な説明
    
  gitプッシュ:
    メッセージ: "GitHubリポジトリにプッシュしますか？"
    詳細表示:
      - 対象リポジトリ: リポジトリURL
      - ブランチ: 対象ブランチ名
      - コミット一覧: プッシュするコミット
      - 警告: "この操作は元に戻せません"
    
  プルリクエスト:
    メッセージ: "プルリクエストを作成しますか？"
    詳細表示:
      - ソースブランチ: 元ブランチ
      - ターゲットブランチ: 対象ブランチ
      - 変更説明: 変更内容の概要
      - 目的: PRの理由
```

### 応答テンプレート
```poml
確認テンプレート:
  コミット要求:
    フォーマット: |
      📝 **コミット確認**
      
      以下の変更をGitにコミットしますか？
      
      **変更ファイル:**
      - {変更ファイル一覧}
      
      **コミットメッセージ:**
      ```
      {提案コミットメッセージ}
      ```
      
      **変更内容の概要:**
      {変更概要}
      
      よろしければ「はい」または「OK」とお答えください。
  
  プッシュ要求:
    フォーマット: |
      🚀 **プッシュ確認**
      
      以下の内容をGitHubにプッシュしますか？
      
      **対象リポジトリ:** {リポジトリURL}
      **ブランチ:** {ブランチ名}
      
      **プッシュするコミット:**
      {コミット一覧}
      
      ⚠️ **注意:** この操作は元に戻せません。
      
      よろしければ「はい」または「OK」とお答えください。
      
  PR要求:
    フォーマット: |
      📋 **プルリクエスト作成確認**
      
      以下の内容でプルリクエストを作成しますか？
      
      **From:** {ソースブランチ}
      **To:** {ターゲットブランチ}
      
      **変更内容:**
      {変更説明}
      
      **目的:**
      {目的}
      
      よろしければ「はい」または「OK」とお答えください。
```

## アプリケーション機能ドキュメント

### 核心機能
```poml
機能:
  メモ管理:
    - 作成: タイトル・カテゴリ・内容・タグ
    - 編集: インラインモーダル編集
    - 削除: 個別削除・一括削除
    - 検索: 全文検索機能
    - フィルター: カテゴリ・タグフィルタリング
    - ソート: 複数ソートオプション
  
  データ管理:
    - 保存: ブラウザローカルストレージ
    - エクスポート: JSONファイルダウンロード
    - インポート: JSONファイルアップロード
    - バックアップ: ユーザー主導エクスポート
    - 復元: ユーザー主導インポート
  
  ユーザーエクスペリエンス:
    - デザイン: アンティーク羊皮紙テーマ
    - レスポンシブ: モバイル・デスクトップ最適化
    - キーボードショートカット: Ctrl+S保存・ESC閉じる
    - 通知: トーストメッセージ
    - 確認: 破壊的操作の警告
```

### 技術仕様
```poml
仕様:
  ブラウザ対応:
    - Chrome: 完全対応
    - Firefox: 完全対応
    - Safari: 完全対応
    - Edge: 完全対応
    - モバイルブラウザ: レスポンシブデザイン対応
  
  パフォーマンス:
    - 読み込み時間: 即座（静的ファイル）
    - メモリ使用量: 最小限
    - オフライン機能: 完全機能
    - データ持続性: localStorage基盤
  
  セキュリティ:
    - データプライバシー: ローカル保存のみ
    - 外部リクエスト: 不要
    - ユーザーデータ: 送信されない
    - ファイルアクセス: ユーザー主導のみ
```

## 緊急時対応手順

### ロールバック手順
```poml
ロールバック手順:
  コミットエラーの場合:
    - ステップ1: git reset --soft HEAD~1
    - ステップ2: 変更内容を再確認
    - ステップ3: ユーザーに指示を求める
  
  プッシュエラーの場合:
    - ステップ1: ユーザーにエラーを説明
    - ステップ2: 安全な場合force pushを提案
    - ステップ3: ユーザーの判断を待つ
  
  アプリケーション破損の場合:
    - ステップ1: 最後の動作コミットに戻す
    - ステップ2: 必要に応じてサーバー再起動
    - ステップ3: 機能確認
    - ステップ4: 実行した行動をユーザーに報告
```

## 遵守要件

### 必須ルール
```poml
必須ルール:
  Git操作:
    - 自動コミット禁止: 絶対要件
    - 自動プッシュ禁止: 重要要件
    - 常時許可確認: 全Git操作前
    - 完全コンテキスト表示: 許可要求前
  
  ユーザーコミュニケーション:
    - 明確な説明: 全提案操作について
    - 詳細要約: 変更内容と影響について
    - 明示的確認: 破壊的操作に必要
    - 有用なガイダンス: ユーザー不明時
  
  アプリケーション整合性:
    - 静的性質維持: 核心機能にサーバー依存なし
    - 機能保持: 全変更中に機能維持
    - 変更テスト: コミット提案前
    - 変更文書化: コミットメッセージとPR説明
```

---

**バージョン:** 1.0  
**最終更新:** 2024-08-22  
**目的:** No File Memoryアプリケーションの静的HTML性質を維持しながら、安全でユーザー制御されたGit操作を確保する。

## 重要な注意事項

### このアプリケーションは静的HTMLです

**No File Memory**は完全に静的なHTMLアプリケーションです：

- **サーバー不要**: ブラウザで直接ファイルを開くだけで動作
- **完全オフライン**: インターネット接続なしで全機能利用可能
- **データはローカル**: すべてのメモはブラウザのlocalStorageに保存
- **単一ファイル**: memotuck.htmlファイル一つで完結
- **依存関係なし**: 外部ライブラリやフレームワーク不要

### GitHubにコミット・プッシュする際の確認事項

AI assistantは以下の場合、**必ずユーザーに確認**を取ります：

1. **ファイル変更後のコミット時**
2. **GitHubへのプッシュ時**
3. **プルリクエスト作成時**

これらの操作は**絶対に自動実行されません**。ユーザーの明示的な許可が必要です。